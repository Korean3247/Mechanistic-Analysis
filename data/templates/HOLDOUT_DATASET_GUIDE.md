# Holdout Dataset Guide

This directory contains starter holdout datasets for the next experimental phase.

Files generated by `scripts/scaffold_holdout_dataset.py`:
- `semantic_requests_holdout_external_template.jsonl`
- `prompts_holdout_external_template.jsonl`
- `semantic_requests_holdout_paraphrase_template.jsonl`
- `prompts_holdout_paraphrase_template.jsonl`

Recommended workflow:
1. Generate starter files:
   - `python3 scripts/scaffold_holdout_dataset.py --kind all --force`
2. Copy the semantic-request template you want to use into `data/` with the final filename:
   - `data/semantic_requests_holdout_external.jsonl`
   - `data/semantic_requests_holdout_paraphrase.jsonl`
3. Expand the semantic-request file to the target size for the paper.
4. Regenerate deterministic framed prompts with the existing prompt generator if you edited semantic requests:
   - `python3 -m authority_analysis.prompt_generator --semantic-requests data/semantic_requests_holdout_external.jsonl --output data/prompts_holdout_external.jsonl`
   - `python3 -m authority_analysis.prompt_generator --semantic-requests data/semantic_requests_holdout_paraphrase.jsonl --output data/prompts_holdout_paraphrase.jsonl`
5. Validate the semantic-request file before running experiments:
   - `python3 scripts/validate_semantic_requests.py --input data/semantic_requests_holdout_external.jsonl`
   - `python3 scripts/validate_semantic_requests.py --input data/semantic_requests_holdout_paraphrase.jsonl`

Schema requirements:
- semantic requests must include: `semantic_request_id`, `base_request`
- prompt rows must include: `prompt_id`, `framing_type`, `semantic_request_id`, `full_prompt`, `safety_label`
- `risk_tier` should be one of `safe`, `borderline`, `unsafe`
- keep paired IDs in `tags` (for example `pair_id:HEX_001`) so auditing remains easy

The template files are deliberately small. They are starter stubs, not final paper-ready holdout datasets.
